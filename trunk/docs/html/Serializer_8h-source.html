<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Evolve: reflectionLearn/methodFactory/Serializer.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000005.html">reflectionLearn</a>&nbsp;/&nbsp;<a class="el" href="dir_000007.html">methodFactory</a></div>
<h1>Serializer.h</h1><a href="Serializer_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef STU_SERIALIZER</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define STU_SERIALIZER</span>
00003 <span class="preprocessor"></span>
00004 <span class="preprocessor">#include &lt;iostream&gt;</span>
00005 <span class="preprocessor">#include &lt;vector&gt;</span>
00006 <span class="preprocessor">#include &lt;string&gt;</span>
00007 
00008 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00009 
00010 <span class="keyword">namespace </span>evolve
00011 {
<a name="l00016"></a><a class="code" href="classevolve_1_1Serializer.html">00016</a>     <span class="keyword">class </span><a class="code" href="classevolve_1_1Serializer.html">Serializer</a> : <span class="keyword">public</span> <a class="code" href="classevolve_1_1CommonAspect.html">CommonAspect</a>
00017     {
00018       <span class="keyword">public</span>: 
<a name="l00024"></a><a class="code" href="classevolve_1_1Serializer.html#a0">00024</a>         <span class="keywordtype">bool</span> serializeString( <span class="keyword">const</span> string&amp; str, <span class="keywordtype">char</span>*&amp; state, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; size )
00025         {
00026             <span class="keyword">const</span> <span class="keywordtype">char</span>* buf = str.c_str();
00027             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> length = strlen(buf); <span class="comment">//multibyte-chars. not sure if string::length returns "characters" or "chars"</span>
00028             state = <span class="keyword">new</span> <span class="keywordtype">char</span>[length + 1];
00029             <span class="comment">//because not everyone has strlcpy</span>
00030             <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; length; ++i )
00031             {
00032                 state[i] = buf[i];
00033             }
00034             state[length] = <span class="charliteral">'\0'</span>;
00035             size = length + 1;
00036             <span class="keywordflow">return</span> <span class="keyword">true</span>;
00037         }
00038    
00045         <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00046"></a><a class="code" href="classevolve_1_1Serializer.html#a1">00046</a>         <span class="keywordtype">bool</span> <a class="code" href="testshift_8cc.html#a0">serialize</a>( T data, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*&amp; state, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; size )
00047         {
00048             size = <span class="keyword">sizeof</span>(T);
00049             state = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[size];
00050             memcpy( state, (<span class="keywordtype">void</span>*)&amp;data, size );
00051             <span class="keywordflow">return</span> <span class="keyword">true</span>;
00052         }
00053    
00060         <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00061"></a><a class="code" href="classevolve_1_1Serializer.html#a2">00061</a>         <span class="keywordtype">bool</span> deserialize( T&amp; data, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* state, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size )
00062         {
00063             memcpy( (<span class="keywordtype">void</span>*)&amp;data, state, size );
00064             <span class="keywordflow">return</span> <span class="keyword">true</span>;
00065         }
00066     
<a name="l00072"></a><a class="code" href="classevolve_1_1Serializer.html#a3">00072</a>         <span class="keywordtype">bool</span> deserializeString( string&amp; str, <span class="keyword">const</span> <span class="keywordtype">char</span>* state, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> length )
00073         {
00074             <span class="keywordflow">if</span>( state[length - 1] != <span class="charliteral">'\0'</span> )
00075             {
00076                 cout &lt;&lt; <span class="stringliteral">"invalid string in deserializeString"</span> &lt;&lt; endl;
00077                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00078             }
00079             str = string( state );
00080             <span class="keywordflow">return</span> <span class="keyword">true</span>;
00081         }
00082     };
00083 };
00084 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Oct 4 21:19:40 2007 for Evolve by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
